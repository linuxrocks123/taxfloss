APPLICABLE_FIGURE = [x] {
x < 133 : 0.0204,
133 : 0.0306,
134 : 0.0312,
135 : 0.0318,
136 : 0.0324,
137 : 0.0330,
138 : 0.0336,
139 : 0.0342,
140 : 0.0348,
141 : 0.0354,
142 : 0.0360,
143 : 0.0366,
144 : 0.0372,
145 : 0.0378,
146 : 0.0384,
147 : 0.0390,
148 : 0.0396,
149 : 0.0402,
150 : 0.0408,
151 : 0.0413,
152 : 0.0417,
153 : 0.0422,
154 : 0.0427,
155 : 0.0432,
156 : 0.0436,
157 : 0.0441,
158 : 0.0446,
159 : 0.0450,
160 : 0.0455,
161 : 0.0460,
162 : 0.0464,
163 : 0.0469,
164 : 0.0474,
165 : 0.0479,
166 : 0.0483,
167 : 0.0488,
168 : 0.0493,
169 : 0.0497,
170 : 0.0502,
171 : 0.0507,
172 : 0.0511,
173 : 0.0516,
174 : 0.0521,
175 : 0.0526,
176 : 0.0530,
177 : 0.0535,
178 : 0.0540,
179 : 0.0544,
180 : 0.0549,
181 : 0.0554,
182 : 0.0558,
183 : 0.0563,
184 : 0.0568,
185 : 0.0573,
186 : 0.0577,
187 : 0.0582,
188 : 0.0587,
189 : 0.0591,
190 : 0.0596,
191 : 0.0601,
192 : 0.0605,
193 : 0.0610,
194 : 0.0615,
195 : 0.0620,
196 : 0.0624,
197 : 0.0629,
198 : 0.0634,
199 : 0.0638,
200 : 0.0643,
201 : 0.0647,
202 : 0.0650,
203 : 0.0654,
204 : 0.0657,
205 : 0.0661,
206 : 0.0664,
207 : 0.0668,
208 : 0.0671,
209 : 0.0675,
210 : 0.0679,
211 : 0.0682,
212 : 0.0686,
213 : 0.0689,
214 : 0.0693,
215 : 0.0696,
216 : 0.0700,
217 : 0.0704,
218 : 0.0707,
219 : 0.0711,
220 : 0.0714,
221 : 0.0718,
222 : 0.0721,
223 : 0.0725,
224 : 0.0728,
225 : 0.0732,
226 : 0.0736,
227 : 0.0739,
228 : 0.0743,
229 : 0.0746,
230 : 0.0750,
231 : 0.0753,
232 : 0.0757,
233 : 0.0760,
234 : 0.0764,
235 : 0.0768,
236 : 0.0771,
237 : 0.0775,
238 : 0.0778,
239 : 0.0782,
240 : 0.0785,
241 : 0.0789,
242 : 0.0793,
243 : 0.0796,
244 : 0.0800,
245 : 0.0803,
246 : 0.0807,
247 : 0.0810,
248 : 0.0814,
249 : 0.0817,
250 : 0.0821,
251 : 0.0824,
252 : 0.0827,
253 : 0.0830,
254 : 0.0833,
255 : 0.0836,
256 : 0.0839,
257 : 0.0842,
258 : 0.0845,
259 : 0.0848,
260 : 0.0851,
261 : 0.0854,
262 : 0.0857,
263 : 0.0859,
264 : 0.0862,
265 : 0.0865,
266 : 0.0868,
267 : 0.0871,
268 : 0.0874,
269 : 0.0877,
270 : 0.0880,
271 : 0.0883,
272 : 0.0886,
273 : 0.0889,
274 : 0.0892,
275 : 0.0895,
276 : 0.0898,
277 : 0.0901,
278 : 0.0904,
279 : 0.0907,
280 : 0.0910,
281 : 0.0913,
282 : 0.0916,
283 : 0.0919,
284 : 0.0922,
285 : 0.0925,
286 : 0.0928,
287 : 0.0931,
288 : 0.0933,
289 : 0.0936,
290 : 0.0939,
291 : 0.0942,
292 : 0.0945,
293 : 0.0948,
294 : 0.0951,
295 : 0.0954,
296 : 0.0957,
297 : 0.0960,
298 : 0.0963,
299 : 0.0966,
300 <= x <= 400 : 0.0969,
401 : 1.0 }

L1 = f1040.L6d

work_L1 = f1040.AGI
work_L2 = f1040.L8b
work_L3 = 0 "TODO"
work_L4 = if(f1040.L20a > f1040.L20b) f1040.L20a - f1040.L20b else 0
work_L5 = work_L1 + work_L2 + work_L3 + work_L4

L2a = work_L5
L2b = 0 "TODO"
L3 = L2a + L2b

FPL_TABLE = [x] { x : $12060 + $4180 * (x - 1) }

L4 = FPL_TABLE[L1]

L5 = if(L3 > L4*4) 401 else ((L3/L4)*100 \\ 0)

L7 = APPLICABLE_FIGURE[L5]
L8a = L3*L7
L8b = L8a/12 \ 4

MONTHS := NUMBER
L1223a := NUMBER
L1223b := NUMBER
L1223f := NUMBER

L11a = L1223a*MONTHS
L11b = L1223b*MONTHS
L11c = L8b*MONTHS
L11d = if(L11b - L11c > 0) L11b - L11c else 0
L11e = if(L11a < L11d) L11a else L11d
L11f = L1223f*MONTHS

L24 = L11e
L25 = L11f
L26 = if(L24 - L25 > 0) L24 - L25 else 0
NET_CREDIT = L26

L27 = if(L25 - L24 > 0) L25 - L24 else 0

REPAYMENT_LIMITATION_TABLE = [x][y] { 
                 | f1040.L1==1 | true |
| x < 200        | 300 | 600 |
| 200 <= x < 300 | 750 | 1500 |
| 300 <= x < 400 | 1250 | 2500 |
| x >= 400       | L27 | L27 | }

L28 = REPAYMENT_LIMITATION_TABLE[L5][-1]
L29 = L27
EXCESS_REPAYMENT = L29
